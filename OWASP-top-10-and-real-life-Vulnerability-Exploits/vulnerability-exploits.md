# OWASP top 10 with real life Vulnerability Exploits

Table of contents:

* 0. [Installing WebGoat](#installing-webgoat)
* 1. [OWASP Top 10 with Examples](#owasp-tot-10-with-examples)
	* 1.1. [Broken Access Control](#BrokenAccessControl)
	* 1.2. [Cryptographic Failures](#CryptographicFailures)
		* 1.2.1. [Crypto Basics Section 1](#crypto-bsics-section-1)
		* 1.2.2. [Crypto Basics Section 2](#crypto-basics-section-2)
	* 1.3. [Injection](#Injection)
		* 1.3.1. [XSS Injection](#XSSInjection)
		* 1.3.2. [SQL Injection](#SQLInjection)
		* 1.3.3. [SSTI Server-Side Template Injection](#SSTInjection)
		* 1.3.4. [HTTP Header Injection](#HTTPHeaderInjection)
		* 1.3.5. [Shell Injection](#ShellInjection)
		* 1.3.6. [Code Injection](#CodeInjection)
		* 1.3.7. [Lightweight Directory Access Protocol (LDAP) Injection](#LDAPInjection)
	* 1.4. [Insecure Design](#InsecureDesign)
	* 1.5. [Security Misconfiguration](#SecurityMisconfiguration)
	* 1.6. [Vulnerable and Outdated Components](#VulnerableandOutdatedComponents)
	* 1.7. [Identification and Authentication Failures](#IdentificationandAuthenticationFailures)
	* 1.8. [Software and Data Integrity Failures](#SoftwareandDataIntegrityFailures)
	* 1.9. [Security Logging and Monitoring Failures](#SecurityLoggingandMonitoringFailures)
	* 1.10. [Server-Side Request Forgery](#Server-SideRequestForgery)
2. [Real-Life Attack Demo](#real-life-attack-demo)
	* 2.0. [Reply Attack](#network-reply-attack)
		* 2.0.1. [Cracking a WPA2 Wifi Password](#cracking-a-wpa2-wifi-password)
	* 2.1. [DoS and DDoS Attacks](#dos-and-ddos-attacks)
	* 2.2. [Man-in-the-middle Attack](#mitm-attack)
		* 2.2.1. [Session hijacking](#session-hijacking)
		* 2.2.2. [SSL Hijacking](#ssl-hijacking)
		* 2.2.3. [Wi-Fi Eavesdropping](#wi-fi-eavesdropping)
		* 2.2.4. [Email Hijacking](#email-hijacking)
		* 2.2.5. [HTTPS Spoofing](#https-spoofing)
		* 2.2.6. [DNS Spoofing](#dns-spoofing)
		* 2.2.7. [IP Spoofing](#ip-spoofing)
	* 2.3. [Malware](#malware)
		* 2.3.1. [Viruses](#viruses)
		* 2.3.2. [Worms](#worms)
		* 2.3.3. [Ransomware](#ransomware)
		* 2.3.4. [Bots](#bots)
		* 2.3.5. [Trojan-horses](#trojan-horses)
		* 2.3.6. [Keyloggers](#keyloggers)
		* 2.3.7. [Rootkits](#rootkits)
		* 2.3.8. [Spyware](#spyware)
		* 2.3.9. [Fileless-malware](#fileless-malware)
		* 2.3.10. [Cryptojacking](#cryptojacking)
		* 2.3.11. [Wiper-malware](#wiper-malware)
		* 2.3.12. [Aadware](#adware)
	* 2.4. [Real Life: Catching a scammer/fraudulent criminal organization with the help of a Trojan and Reverse Shell](#real-life-catching-a-scammerfraudulent-criminal-organization-with-the-help-of-a-trojan-and-reverse-shell)

## 0. <a name="installing-webgoat"></a>Installing Webgoat

We don't describe all requirements as for now. Maybe at some point in the future.

Pull this dockerhub repository into your local hub with docker If you haven't already:
> docker pull webgoat/goatandwolf

List all the docker containers:
> sudo docker ps -a

Start the container:
> sudo docker container start 'name-of-the-container'

Again
> sudo docker ps -a

to find the `port` our docker container is now runing on.

In a web browser type the `port` in the address field.

For example:
> localhost_3000

or
> localhost:8080/WebGoat

Now `Disconnect` from the `Internet`!

```
"
terms of use: 

While running this program your machine will be extremely vulnerable to attack.You should disconnect from the Internet while using this program. WebGoat's default configuration binds to localhost to minimize the exposure.

This program is for educational purposes only. If you attempt these techniques without authorization, you are very likely to get caught. If you are caught engaging in unauthorized hacking, most companies will fire you. Claiming that you were doing security research will not work as that is the first thing that all hackers claim.
"
```

to stop the server:
> sudo docker container stop 'name-of-the-container'

## 1. <a name="owasp-top-10-with-examples"></a>OWASP Tot 10 with Examples

###  1.1. <a name='BrokenAccessControl'></a>Broken Access Control

###  1.2. <a name='CryptographicFailures'></a>Cryptographic Failures 

#### 1.2.1. <a name="crypto-basics-secton-1"></a>Crypto Bsics Section 1:

Next we will go through the following forms of techniques (the goal is to get familyar with them):
- Encoding
- Hashing
- Encryption
- Signing
- Keystores
- Security defaults
- Post quantum crypto

#### Base64 Encoding

Encoding is not true cryptography, but it is widely used in various standards related to cryptographic functions, especially Base64 encoding.

Base64 encoding is a method used to convert any type of byte data into a specific range of bytes, which are ASCII-readable. This makes it easier to transfer binary data, such as secret or private keys. You can even print or write these encoded values. The process is reversible, so with the encoded version, you can recreate the original data.

For more details, you can refer to Wikipedia. Essentially, Base64 goes through all the bytes and converts each set of 6 bits into a readable byte (8 bits). This results in the encoded data being about 33% larger than the original.

Examples:

- "Aye" becomes "QXll"
- "09gxH" becomes "MDlneEg="

##### Basic Authentication

Basic authentication is sometimes used by web applications and utilizes Base64 encoding. Therefore, it's crucial to use Transport Layer Security (TLS, commonly known as HTTPS) to protect the username and password from being read by others when sent to the server.

Example:

```bash
$ echo -n "rece:ficeBOOMx3" | base64
cmVjZTpmaWNlQk9PTXgz
```

The HTTP header will look like this:

```makefile
Authorization: Basic cmVjZTpmaWNlQk9PTXgz
```

Now, suppose you intercept the following header:

```makefile
Authorization: Basic dW1wYTpsdW1wYQ==
```

What are the username and password?

solution: 
> echo -n "Base64 encoded string" | base64 -d && echo -e "\n"

Note: I already know much more advanced cryptographic content from the Codecademy Data Science course. Sometimes it gets a little annoying. I'm running circles. But anyway I do it for the hacking. Hopefully I'll come up with something challenging soon.

#### 1.2.2. <a name="crypto-basics-section-2"></a>Crypto Basics Section 2:

#### Other Encodings:
- URL encoding
- HTML encoding
- UUEncode
- XOR encoding

#### XOR encoded password task

Find out the original password from a default XOR encoded string.

A shell script for encoding / decoding XOR: https://www.doyler.net/security-not-included/shellcode-xor-encoder-decoder

(Alternatively an online XOR decoder: https://strelitzia.net/wasXORdecoder/wasXORdecoder.html)

###  1.3. <a name="Injection"></a>Injection

####  1.3.1. <a name="XSSInjection"></a>XSS Injection
####  1.3.2. <a name="SQLInjection"></a>SQL Injection
####  1.3.3. <a name="SSTInjection"></a>SSTI Server-Side Template Injection
####  1.3.4. <a name="HTTPHeaderInjection"></a>HTTP Header Injection
####  1.3.5. <a name="ShellInjection"></a>Shell Injection
####  1.3.6. <a name="CodeInjection"></a>Code Injection
####  1.3.7. <a name="LDAPInjection"></a>Lightweight Directory Access Protocol (LDAP) Injection

###  1.4. <a name="InsecureDesign"></a>Insecure Design

###  1.5. <a name="SecurityMisconfiguration"></a>Security Misconfiguration

###  1.6. <a name="VulnerableandOutdatedComponents"></a>Vulnerable and Outdated Components

###  1.7. <a name="IdentificationandAuthenticationFailures"></a>Identification and Authentication Failures

###  1.8. <a name="SoftwareandDataIntegrityFailures"></a>Software and Data Integrity Failures

###  1.9. <a name="SecurityLoggingandMonitoringFailures"></a>Security Logging and Monitoring Failures

###  1.10. <a name="Server-SideRequestForgery"></a>Server-Side Request Forgery

## 2. <a name="real-life-attack-demo"></a>Real-Life Attack Demo

### 2.0. <a name="network-reply-Attack"></a>Network/ Reply Attack
#### 2.0.1. <a name="cracking-a-wpa2-wifi-password"></a>Cracking a WPA2 Wifi Password
##### Deauthentication
https://sudorealm.com/blog/deauthentication-attack-using-kali-linux
##### Capturing 4-Way handshake
https://www.youtube.com/watch?v=4rnrfbb1-Wg&ab_channel=InfoSecPat

https://www.krackattacks.com/

https://amandinegh.gitbook.io/cyberadventure/wireless/attacking-wireless-network/capture-the-4-way-handshake
 
### 2.1. <a name="dos-and-ddos-attacks"></a>DoS and DDoS Attacks 

### 2.2. <a name="mitm-attack"></a>Man-in-the-middle MITM Attack

#### 2.2.1. <a name="session-hijacking"></a>Session hijacking

#### 2.2.2. <a name="ssl-hijacking"></a>SSL Hijacking

#### 2.2.3. <a name="wi-fi-eavesdropping"></a>Wi-Fi Eavesdropping

#### 2.2.4. <a name="email-hijacking"></a>Email Hijacking

#### 2.2.5. <a name="https-spoofing"></a>HTTPS Spoofing

#### 2.2.6. <a name="dns-spoofing"></a>DNS Spoofing

#### 2.2.7. <a name="ip-spoofing"></a>IP Spoofing


### 2.3. <a name="malware"></a>Malware

#### 2.3.1. <a name="viruses"></a>Viruses
#### 2.3.2. <a name="worms"></a>Worms
#### 2.3.3. <a name="ransomware"></a>Ransomware
#### 2.3.4. <a name="bots"></a>Bots
#### 2.3.5. <a name="trojan-horses"></a>Trojan horses
#### 2.3.6. <a name="keyloggers"></a>Keyloggers
#### 2.3.7. <a name="rootkits"></a>Rootkits
#### 2.3.8. <a name="spyware"></a>Spyware
#### 2.3.9. <a name="fileless-malware"></a>Fileless malware
#### 2.3.10. <a name="cryptojacking"></a>Cryptojacking
#### 2.3.11. <a name="wiper-malware"></a>Wiper malware
#### 2.3.12. <a name="adware"></a>Adware

### 2.4. <a name="real-life-catching-a-scammerfraudulent-criminal-organization-with-the-help-of-a-trojan-and-reverse-shell"></a>Real Life: Catching a scammer/fraudulent criminal organization with the help of a Trojan and Reverse Shell

This is a real life example I could have done to a friend who got scammed.
I'm not sure jet if I'm going to reveal it just to show off my abilities to some unknown corporate people who won't work with me anyway because I'm too beginner level.
Maybe I'm going to tell just the story later.